<!DOCTYPE HTML>
<html lang="" >
    <head>
        <title>Utilizing Matchers Â· GitBook</title>
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="Let&#39;s see how these different Matcher types are used in practice.">
        <meta name="generator" content="GitBook 3.0.0-pre.5">
        
        
        
    
    <link rel="stylesheet" href="../../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="public-interface.html" />
    
    
    <link rel="prev" href="matchers.html" />
    

    </head>
    <body>
        
<div class="book"
    data-level="3.2.4"
    data-chapter-title="Utilizing Matchers"
    data-filepath="composition/example/utilizing-matchers.md"
    data-basepath="../../../docs"
    data-revision="Mon May 02 2016 10:43:52 GMT+0200 (CEST)"
    data-innerlanguage="">
    

<div class="book-summary">
    
    <nav role="navigation">
        <ul class="summary">
            
            

            


            
            
    
        <li class="chapter " data-level="0" data-path="../../">
            
                <a href="../../">
            
                    
                    Why the Elm Architecture matters?
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1" data-path="../../getting-started/">
            
                <a href="../../getting-started/">
            
                    
                        <b>1.</b>
                    
                    Getting Started Tutorial
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.1" data-path="../../getting-started/necessary-boilerplate.html">
            
                <a href="../../getting-started/necessary-boilerplate.html">
            
                    
                        <b>1.1.</b>
                    
                    Necessary boilerplate
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../../getting-started/hello-world.html">
            
                <a href="../../getting-started/hello-world.html">
            
                    
                        <b>1.2.</b>
                    
                    Hello World!
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2" data-path="../../gif-viewer/">
            
                <a href="../../gif-viewer/">
            
                    
                        <b>2.</b>
                    
                    GifViewer tutorial
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.1" data-path="../../gif-viewer/shaping-model.html">
            
                <a href="../../gif-viewer/shaping-model.html">
            
                    
                        <b>2.1.</b>
                    
                    Shaping out initial Model
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.2" data-path="../../gif-viewer/rendering-view.html">
            
                <a href="../../gif-viewer/rendering-view.html">
            
                    
                        <b>2.2.</b>
                    
                    Rendering View
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.3" data-path="../../gif-viewer/side-effects.html">
            
                <a href="../../gif-viewer/side-effects.html">
            
                    
                        <b>2.3.</b>
                    
                    AJAX &amp; Side Effects in practice
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.4" data-path="../../gif-viewer/unit-tests.html">
            
                <a href="../../gif-viewer/unit-tests.html">
            
                    
                        <b>2.4.</b>
                    
                    Writing Unit Tests
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="3" data-path="../">
            
                <a href="../">
            
                    
                        <b>3.</b>
                    
                    Composition
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.1" data-path="../action-composition.html">
            
                <a href="../action-composition.html">
            
                    
                        <b>3.1.</b>
                    
                    Action Composition
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.2" data-path="./">
            
                <a href="./">
            
                    
                        <b>3.2.</b>
                    
                    Real Composition Example
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.2.1" data-path="updater-composition.html">
            
                <a href="updater-composition.html">
            
                    
                        <b>3.2.1.</b>
                    
                    Updater Composition
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.2.2" data-path="action-composition-practice.html">
            
                <a href="action-composition-practice.html">
            
                    
                        <b>3.2.2.</b>
                    
                    Action Composition in practice
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.2.3" data-path="matchers.html">
            
                <a href="matchers.html">
            
                    
                        <b>3.2.3.</b>
                    
                    Introduction Matchers
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="3.2.4" data-path="utilizing-matchers.html">
            
                <a href="utilizing-matchers.html">
            
                    
                        <b>3.2.4.</b>
                    
                    Utilizing Matchers
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.2.5" data-path="public-interface.html">
            
                <a href="public-interface.html">
            
                    
                        <b>3.2.5.</b>
                    
                    Using public interface
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="3.3" data-path="../dynamic-list/">
            
                <a href="../dynamic-list/">
            
                    
                        <b>3.3.</b>
                    
                    Dynamic List of Components
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.3.1" data-path="../dynamic-list/updater-parameterized-matcher.html">
            
                <a href="../dynamic-list/updater-parameterized-matcher.html">
            
                    
                        <b>3.3.1.</b>
                    
                    Updater with ParmeterizedMatcher
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="4" data-path="../../custom-matchers/">
            
                <a href="../../custom-matchers/">
            
                    
                        <b>4.</b>
                    
                    Custom Matchers
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="4.1" data-path="../../custom-matchers/writing-custom-matcher.html">
            
                <a href="../../custom-matchers/writing-custom-matcher.html">
            
                    
                        <b>4.1.</b>
                    
                    Writing Custom Matcher
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="5" data-path="../../static-typing/">
            
                <a href="../../static-typing/">
            
                    
                        <b>5.</b>
                    
                    Static Typing - FlowType
            
                </a>
            

            
        </li>
    

            <li class="divider"></li>
            

            <li>
                <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
                    Published with GitBook
                </a>
            </li>
        </ul>
    </nav>
    
</div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    
<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="../../../docs" >Utilizing Matchers</a>
    </h1>
</div>



                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            <section class="normal markdown-section">
                            
                            <h2 id="using-matchers">Using Matchers</h2>
<p>Let&apos;s see how these different Matcher types are used in practice.</p>
<p>We need to proxy all Actions tagged with <code>Top</code> or <code>Bottom</code> to the <code>GifViewer</code> Updater, which mutates the state and potentially emits Side Effects. Imagine our <code>GifViewerPair</code> Updater as a person who unwraps a package which may contain another package, and if so hands it over to another person (the <code>GifViewer</code> Updater) who is responsible for handling the contents of the package. Keep in mind that the package can be wrapped many times for many people (Component Updaters), with each one handing off to the person &quot;below&quot; them.</p>
<p>We need to strip <code>Top.</code> or <code>Bottom.</code> off the beginning of the Action type and provide rest to the underlying Child Updater as unwrapped Action:</p>
<pre><code class="lang-javascript"><span class="hljs-keyword">import</span> { Updater, mapEffects } <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;redux-elm&apos;</span>;

<span class="hljs-keyword">import</span> gifViewerUpdater, { init <span class="hljs-keyword">as</span> gifViewerInit } <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;../gif-viewer/updater&apos;</span>;

<span class="hljs-keyword">const</span> funnyCatsGifViewerInit = gifViewerInit(<span class="hljs-string">&apos;funny cats&apos;</span>);
<span class="hljs-keyword">const</span> funnyDogsGifViewerInit = gifViewerInit(<span class="hljs-string">&apos;funny dogs&apos;</span>);

<span class="hljs-keyword">export</span> <span class="hljs-function"><span class="hljs-keyword">function</span>* <span class="hljs-title">init</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">return</span> {
    top: <span class="hljs-keyword">yield</span>* mapEffects(funnyCatsGifViewerInit(), <span class="hljs-string">&apos;Top&apos;</span>),
    bottom: <span class="hljs-keyword">yield</span>* mapEffects(funnyDogsGifViewerInit(), <span class="hljs-string">&apos;Bottom&apos;</span>)
  };
};

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">new</span> Updater(init)
  .case(<span class="hljs-string">&apos;Top&apos;</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>*(<span class="hljs-params">model, action</span>) </span>{
    <span class="hljs-keyword">return</span> {
      ...model,
      top: <span class="hljs-keyword">yield</span>* mapEffects(gifViewerUpdater(model.top, action), <span class="hljs-string">&apos;Top&apos;</span>)
    };
  })
  .case(<span class="hljs-string">&apos;Bottom&apos;</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>*(<span class="hljs-params">model, action</span>) </span>{
    <span class="hljs-keyword">return</span> {
      ...model,
      bottom: <span class="hljs-keyword">yield</span>* mapEffects(gifViewerUpdater(model.bottom, action), <span class="hljs-string">&apos;Bottom&apos;</span>)
    };
  })
  .toReducer();
</code></pre>
<p>We&apos;ve basically implemented the behavior of people unwrapping packages and handing them off to someone else. The <code>GifViewerPair</code> Updater just takes any Action starting with <code>Top</code> or <code>Bottom</code>, unwraps its contents and passes them to the <code>GifViewer</code> Updater along with the corresponding Model slice.</p>
<p>We must not forget <code>mapEffects</code> because handling that Action in <code>GifViewer</code> Updater may potentially dispatch another Action. In this case we would need to &quot;wrap&quot; it back so that when it gets back to the Updater loop, the Action type contains all the necessary segments starting from the top of the Updater hierarchy. So if the <code>Top</code> Component dispatches a <code>Foo</code> Action, <code>mapEffects</code> makes sure the Action type is wrapped so that it is <code>Top.Foo</code> and not just <code>Foo</code>.</p>
<p>Let&apos;s compile and run the Application and see the result:</p>
<p><img src="../../assets/10.png" alt="gif-viewer-pair-4"></p>
<p>When you click the &quot;More Please!&quot;&quot; button on either Viewer, nothing happens. Here&apos;s why:</p>
<p><img src="../../assets/11.png" alt="gif-viewer-pair-5"></p>
<p>The <code>RequestMore</code> Action is not wrapped. We need to make one small adjustment to <code>GifViewerPair</code>:</p>
<pre><code class="lang-javascript"><span class="hljs-keyword">import</span> React <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;react&apos;</span>;

<span class="hljs-keyword">import</span> GifViewer <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;../gif-viewer/view&apos;</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> ({ model, dispatch }) =&gt; (
  &lt;div&gt;
    &lt;GifViewer model={model.top} dispatch={dispatch} /&gt;
    &lt;GifViewer model={model.bottom} dispatch={dispatch} /&gt;
    &lt;br /&gt;
    &lt;button onClick={() =&gt; dispatch({ type: &apos;Load&apos; })}&gt;Load Both!&lt;/button&gt;
  &lt;/div&gt;
);
</code></pre>
<p>The <code>dispatch</code> function passed to the child View instance should automatically tag all the Actions with the <code>Top</code> or <code>Bottom</code> prefix (i.e. wrap the action). This is exactly the same thing we did in our Updater using the <code>mapEffects</code> function.</p>
<p><code>redux-elm</code> provides a function to do this automatically for you. <code>forwardTo</code> takes the <code>dispatch</code> function as its first argument and an arbitrary number of additional string arguments that define how Actions dispatched by that function should be wrapped:</p>
<pre><code class="lang-javascript"><span class="hljs-keyword">import</span> React <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;react&apos;</span>;
<span class="hljs-keyword">import</span> { forwardTo } <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;redux-elm&apos;</span>;

<span class="hljs-keyword">import</span> GifViewer <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;../gif-viewer/view&apos;</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> ({ model, dispatch }) =&gt; (
  &lt;div&gt;
    &lt;GifViewer model={model.top} dispatch={forwardTo(dispatch, &apos;Top&apos;)} /&gt;
    &lt;GifViewer model={model.bottom} dispatch={forwardTo(dispatch, &apos;Bottom&apos;)} /&gt;
    &lt;br /&gt;
    &lt;button onClick={() =&gt; dispatch({ type: &apos;Load&apos; })}&gt;Load Both!&lt;/button&gt;
  &lt;/div&gt;
);
</code></pre>
<p>Save and hit the Refresh button. Voil&#xE0;! Now the &quot;More Please!&quot; button works as expected.</p>

                            
                            </section>
                        </div>
                    </div>
                
            </div>

            
                
                <a href="matchers.html" class="navigation navigation-prev " aria-label="Previous page: Introduction Matchers">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="public-interface.html" class="navigation navigation-next " aria-label="Next page: Using public interface">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>
</div>

        
    <script src="../../gitbook/app.js"></script>
    
        
        <script src="../../gitbook/gitbook-plugin-search/lunr.min.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-fontsettings/buttons.js"></script>
        
    
    <script>
    require(["gitbook"], function(gitbook) {
        gitbook.start({"highlight":{},"search":{"maxIndexSize":1000000},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"}}});
    });
    </script>

    </body>
</html>
